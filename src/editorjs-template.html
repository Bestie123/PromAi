<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor.js Template</title>
    <style>
        body {
            background: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        .editorjs-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        #editorjs {
            min-height: 300px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 10px;
        }
        .ce-block__content, .ce-toolbar__content {
            max-width: 100%;
        }
        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }
        .controls button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #4CAF50;
            color: white;
        }
        .controls button:hover {
            background: #45a049;
        }
        #preview {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 4px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="editorjs-container">
        <h1>üìù Editor.js</h1>
        <div id="editorjs"></div>
        <div class="controls">
            <button onclick="saveData()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button onclick="loadData()">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
            <button onclick="clearData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
            <button onclick="showPreview()">üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
        </div>
        <div id="preview"></div>
    </div>

    <!-- Editor.js CDN - –†–ê–ë–û–ß–ò–ï –í–ï–†–°–ò–ò -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@2.28.2/dist/editorjs.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/paragraph@2.11.3/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/header@2.7.0/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/nested-list@1.4.2/dist/nested-list.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/checklist@1.5.0/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/quote@2.5.0/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/delimiter@1.3.0/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/table@2.2.2/dist/table.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/code@2.8.0/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/raw@2.4.0/dist/bundle.js"></script>

    <script>
        let editor;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
        window.addEventListener('load', function() {
            localStorage.removeItem('editorjs-data');
            setTimeout(() => {
                editor = new EditorJS({
                    holder: 'editorjs',
                    placeholder: '–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å...',
                    tools: {
                        paragraph: Paragraph,
                        header: Header,
                        list: {
                            class: NestedList,
                            inlineToolbar: true,
                            config: {
                                defaultStyle: 'unordered'
                            }
                        },
                        checklist: Checklist,
                        quote: Quote,
                        delimiter: Delimiter,
                        table: Table,
                        code: CodeTool,
                        raw: RawTool
                    }
                });
            }, 1000);
        });
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        async function saveData() {
            const data = await editor.save();
            localStorage.setItem('editorjs-data', JSON.stringify(data));
            alert('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        async function loadData() {
            const stored = localStorage.getItem('editorjs-data');
            if (stored) {
                await editor.destroy();
                editor = new EditorJS({
                    holder: 'editorjs',
                    tools: {
                        paragraph: Paragraph,
                        header: Header,
                        list: {
                            class: NestedList,
                            inlineToolbar: true,
                            config: {
                                defaultStyle: 'unordered'
                            }
                        },
                        checklist: Checklist,
                        quote: Quote,
                        delimiter: Delimiter,
                        table: Table,
                        code: CodeTool,
                        raw: RawTool
                    },
                    data: JSON.parse(stored)
                });
                alert('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
            } else {
                alert('‚ö†Ô∏è –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö');
            }
        }
        
        // –û—á–∏—Å—Ç–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
        async function clearData() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä?')) {
                await editor.destroy();
                editor = new EditorJS({
                    holder: 'editorjs',
                    tools: {
                        paragraph: Paragraph,
                        header: Header,
                        list: {
                            class: NestedList,
                            inlineToolbar: true,
                            config: {
                                defaultStyle: 'unordered'
                            }
                        },
                        checklist: Checklist,
                        quote: Quote,
                        delimiter: Delimiter,
                        table: Table,
                        code: CodeTool,
                        raw: RawTool
                    }
                });
                localStorage.removeItem('editorjs-data');
                document.getElementById('preview').style.display = 'none';
            }
        }
        
        // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä HTML
        async function showPreview() {
            try {
                const data = await editor.save();
                const preview = document.getElementById('preview');
                
                if (!data.blocks || data.blocks.length === 0) {
                    preview.innerHTML = '<p style="color: #999;">üìù –†–µ–¥–∞–∫—Ç–æ—Ä –ø—É—Å—Ç. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–µ–Ω—Ç.</p>';
                    preview.style.display = 'block';
                    return;
                }
                
                let html = '';
                data.blocks.forEach(block => {
                    switch(block.type) {
                        case 'header':
                            if (block.data.text && block.data.text.trim()) {
                                html += `<h${block.data.level}>${block.data.text}</h${block.data.level}>`;
                            }
                            break;
                        case 'paragraph':
                            if (block.data.text && block.data.text.trim()) {
                                html += `<p>${block.data.text}</p>`;
                            }
                            break;
                        case 'list':
                            if (block.data.items && block.data.items.length > 0) {
                                const tag = block.data.style === 'ordered' ? 'ol' : 'ul';
                                const renderList = (items) => {
                                    return items.map(item => {
                                        let li = `<li>${item.content}`;
                                        if (item.items && item.items.length > 0) {
                                            li += `<${tag}>${renderList(item.items)}</${tag}>`;
                                        }
                                        li += '</li>';
                                        return li;
                                    }).join('');
                                };
                                html += `<${tag}>${renderList(block.data.items)}</${tag}>`;
                            }
                            break;
                        case 'checklist':
                            if (block.data.items && block.data.items.length > 0) {
                                html += `<ul>${block.data.items.map(i => `<li><input type="checkbox" ${i.checked ? 'checked' : ''}> ${i.text}</li>`).join('')}</ul>`;
                            }
                            break;
                        case 'quote':
                            if (block.data.text && block.data.text.trim()) {
                                html += `<blockquote>${block.data.text}<cite>${block.data.caption || ''}</cite></blockquote>`;
                            }
                            break;
                        case 'code':
                            if (block.data.code && block.data.code.trim()) {
                                html += `<pre><code>${block.data.code}</code></pre>`;
                            }
                            break;
                        case 'delimiter':
                            html += '<hr>';
                            break;
                        case 'table':
                            if (block.data.content && block.data.content.length > 0) {
                                html += `<table border="1">${block.data.content.map(row => `<tr>${row.map(cell => `<td>${cell}</td>`).join('')}</tr>`).join('')}</table>`;
                            }
                            break;
                        case 'raw':
                            if (block.data.html && block.data.html.trim()) {
                                html += block.data.html;
                            }
                            break;
                    }
                });
                
                if (!html || html.trim() === '') {
                    preview.innerHTML = '<p style="color: #999;">üìù –†–µ–¥–∞–∫—Ç–æ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—É—Å—Ç—ã–µ –±–ª–æ–∫–∏. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç.</p>';
                } else {
                    preview.innerHTML = html;
                }
                preview.style.display = 'block';
            } catch (error) {
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
        }
    </script>
</body>
</html>
